---
title: "Otter - Vega"
author: "Markus Fjellstad Israelsen"
date: "22 12 2021"
output: html_document
editor_options: 
  chunk_output_type: console
---

Load library
```{r Library, echo = FALSE}

library(dplyr)
library(rgdal)
library(raster)
library(rgeos)
library(spatial)
library(maptools)
library(readxl)
library(writexl)
library(lubridate)

```

Load data
```{r Datasets}

coastlineVega = terra::vect("C:/Users/markus.israelsen/OneDrive - NINA/Oter/Vega/R-mappe - Kystkontur/Coastline/coastLineVegaLength.shp")
coastlineMudd = terra::vect("C:/Users/markus.israelsen/OneDrive - NINA/Oter/Vega/R-mappe - Kystkontur/Coastline/coastLineMuddværetLength.shp")
coastlineMuddPoints = terra::vect("C:/Users/markus.israelsen/OneDrive - NINA/Oter/Vega/R-mappe - Kystkontur/Coastline/coastLineMuddværetPointsLength.shp")
plot(coastlineVega)
plot(coastlineMudd)
plot(coastlineMuddPoints, col = "red", add = TRUE)

vegaCoastlineKM = sum(coastlineVega$length)/1000
muddTotalCoastlineKM = sum(coastlineMudd$length)/1000
muddCoastlineKM = sum(coastlineMuddPoints$length)/1000

otterPointsRaw = read_xlsx("C:/Users/markus.israelsen/OneDrive - NINA/Oter/Vega/RawOterVegaMuddUTM.xlsx")

plot(coastlineMudd)
plot(coastlineMuddPoints, col = "red", add = TRUE)

# Number of otters per 10km coastline
# Group by year & area
# count the number of otter observations and divide by the length of the coastline
otterPointsRaw = otterPointsRaw %>% mutate(Year = year(Date), Counter = 1)
otterPointsVega = otterPointsRaw %>% filter(Year != 2018 & Area == "Vega") # Filtered out the five points in 2018
otterPointsMudd = otterPointsRaw %>% filter(Area == "Muddværet") 

opVega = otterPointsVega %>% group_by(Year) %>% summarise(Counts = sum(Counter))
opMudd = otterPointsMudd %>% group_by(Year) %>% summarise(Counts = sum(Counter))

cbind(opVega, OtterPerKM = opVega$Counts/vegaCoastlineKM, OtterPer10KM = (opVega$Counts/vegaCoastlineKM)*10)
cbind(opMudd, OtterPerKM = opMudd$Counts/muddTotalCoastlineKM, OtterPer10KM = (opMudd$Counts/muddTotalCoastlineKM)*10)
cbind(opMudd, OtterPerKM = opMudd$Counts/muddCoastlineKM, OtterPer10KM = (opMudd$Counts/muddCoastlineKM)*10)



```

